---
title: "ANOVA  1 Fator"
author: "Yuri"
format: html

execute: 
  freeze: auto
  cache: true
  warning: false
---

## Quando temos mais de 2 tratamentos utilizamos Anova.

definição de P value: é probabilidade de obter o valor encontrado, ou maior que ele, dada hipótese nula.

###### ***ESTUDAR :alternativa do teste wilcox e mannwhiltney***

```{r}
library(agricolae)
library(readxl)
library(tidyverse)

micelial <- read_excel("dados-diversos.xlsx", "micelial")
```

Modelo:

```{r}
aov1 <- aov(tcm~especie, data = micelial)
summary(aov1)
library(performance)
check_heteroscedasticity(aov1)
library(DHARMa)
plot(simulateResiduals(aov1))
```

```{r}
insects <- tbl_df(InsectSprays)
dat1 <- insects |> 
  ggplot(aes(spray, count))+
  geom_boxplot()
aov2 <- aov(sqrt(count)~spray, data = insects)
summary(aov2)
check_normality(aov2)
check_heteroscedasticity(aov2)

library(emmeans)

aov2_means <- emmeans(aov2, ~spray,
                      type = "response")
aov2_means
pwpm(aov2_means)

library(multcomp)
library(multcompView)

cld(aov2_means)
```

Ajustando modelo aplicando SQRT. Podemos também usar log ou (logX + 0.05):

```{r}
aov2 <- aov(count~spray, data =insects)
summary(aov2)

check_normality(aov2)
check_heteroscedasticity(aov2)
```

OPTANDO POR TESTE NÃO PARAMÉTRICO:

```{r}
kruskal.test(count~spray, data = insects)
install.packages("agricolae")
library(agricolae)

kruskal(insects$count, insects$spray,
        console = TRUE)
```

Modelo linear generalizado:

```{r}
glml <- glm(count~spray,
            data = insects,
            family = poisson(link = "identity"))

plot(simulateResiduals(glml))

summary(glml)
```

Modelo não-PARAMÉTRICO:

```{r}
library(tidyverse)
library(MASS)

insects<- InsectSprays
b<- boxcox(lm(insects$count+0.1~1))
lambda <- b$x[which.max(b$y)]
lambda

insects$count2 <- (insects$count ^lambda - 1)/lambda
insects$count2
hist(insects$count2)
```
